# 基础练习题

#### 练习题 1：创建和查看文件

**任务**：

1. 在`/home/user1`目录下创建一个名为`notes.txt`的空文件。
2. 向`notes.txt`写入内容“Welcome to Linux!”。
3. 查看`notes.txt`的内容和权限。

**目标**：

- 掌握`touch`、`echo`、`cat`、`ls -l`命令。

#### 练习题 2：目录操作与复制

**任务**：

1. 创建一个目录`/home/user1/docs`及其子目录`archive`。
2. 将`notes.txt`复制到`/home/user1/docs/archive`。
3. 列出`docs/archive`目录内容，包含隐藏文件。

**目标**：

- 掌握`mkdir`、`cp`、`ls -a`命令。

#### 练习题 3：基本权限修改

**任务**：

1. 将`notes.txt`的权限设置为：所有者可读写，组和其他用户只读。
2. 将`docs`目录的权限设置为：所有者可读写执行，组和其他用户只读执行。
3. 查看修改后的权限。

**目标**：

- 掌握`chmod`、`ls -l`命令。

#### 练习题 4：文件查找

**任务**：

1. 在`/home/user1`目录下查找所有`.txt`文件。
2. 在`notes.txt`中搜索包含“Linux”关键字的行。

**目标**：

- 掌握`find`、`grep`命令。

---

### 三、进阶练习题

以下练习适合有一定基础的用户，涉及复杂文件操作、权限管理和Logrotate配置。

#### 练习题 5：多用户权限管理

**任务**：

1. 创建用户`user2`和组`mygroup`（需要`root`权限）。
2. 将`notes.txt`的所有者改为`user2`，所属组改为`mygroup`。
3. 设置`notes.txt`权限为：所有者可读写，组可读，其他无权限。
4. 以`user1`身份验证是否能读取`notes.txt`（假设`user1`不在`mygroup`）。

**目标**：

- 掌握`useradd`、`groupadd`、`chown`、`chgrp`、`chmod`、`su`命令。

#### 练习题 6：共享目录与SGID

**任务**：

1. 创建目录`/home/user1/shared`。
2. 设置`shared`目录的所属组为`mygroup`，并添加SGID权限，确保新文件继承组。
3. 在`shared`目录中创建文件`team.txt`，验证其所属组。
4. 添加`user2`到`mygroup`，确保`user2`可访问`shared`目录内容。

**目标**：

- 掌握`mkdir`、`chgrp`、`chmod`、`usermod`、`ls -l`命令。

#### 练习题 7：日志文件轮换与权限

**任务**：

1. 创建日志目录`/var/log/myapp`（需要`root`权限）。
2. 创建日志文件`/var/log/myapp/app.log`，写入测试内容“Application log entry”。
3. 设置`app.log`权限为：所有者（`myuser`）可读写，组（`mygroup`）可读。
4. 配置Logrotate，每天轮换`app.log`，保留3天日志，压缩旧日志，新日志权限为`640 myuser mygroup`。
5. 手动运行Logrotate并验证结果。

**目标**：

- 整合`mkdir`、`touch`、`echo`、`chmod`、`chown`、Logrotate配置和运行。

---

### 五、练习答案

以下是每道练习题的参考答案，包含命令和预期输出。

#### 答案 1：创建和查看文件

# 1. 创建空文件

touch notes.txt

# 2. 写入内容

echo "Welcome to Linux!" > notes.txt

# 3. 查看内容和权限

cat notes.txt
ls -l notes.txt

**预期输出**：

- `cat notes.txt`：`Welcome to Linux!`
- `ls -l notes.txt`：类似`-rw-rw-r-- 1 user1 user1 17 May 28 08:57 notes.txt`（权限取决于`umask`）。

#### 答案 2：目录操作与复制

# 1. 创建目录和子目录

mkdir -p docs/archive

# 2. 复制文件

cp notes.txt docs/archive/

# 3. 查看目录内容

ls -a docs/archive

**预期输出**：

- `ls -a docs/archive`：`. .. notes.txt`

#### 答案 3：基本权限修改

# 1. 修改文件权限

chmod 644 notes.txt

# 2. 修改目录权限

chmod 755 docs

# 3. 查看权限

ls -l notes.txt
ls -ld docs

**预期输出**：

- `ls -l notes.txt`：类似`-rw-r--r-- 1 user1 user1 17 May 28 08:57 notes.txt`
- `ls -ld docs`：类似`drwxr-xr-x 3 user1 user1 4096 May 28 08:57 docs`

#### 答案 4：文件查找

# 1. 查找.txt文件

find /home/user1 -type f -name "*.txt"

# 2. 搜索关键字

grep "Linux" notes.txt

**预期输出**：

- `find`：`/home/user1/notes.txt`、`/home/user1/docs/archive/notes.txt`
- `grep`：`Welcome to Linux!`

#### 答案 5：多用户权限管理

# 1. 创建用户和组（需要root权限）

sudo useradd -m user2
sudo groupadd mygroup

# 2. 修改所有者和组

sudo chown user2:mygroup notes.txt

# 3. 设置权限

sudo chmod 640 notes.txt

# 4. 验证权限（以user1身份）

cat notes.txt
su - user2 -c "cat /home/user1/notes.txt"

**预期输出**：

- `ls -l notes.txt`：类似`-rw-r----- 1 user2 mygroup 17 May 28 08:57 notes.txt`
- `cat notes.txt`（以`user1`）：失败，`Permission denied`（除非`user1`在`mygroup`）
- `su - user2 ...`：`Welcome to Linux!`

#### 答案 6：共享目录与SGID

# 1. 创建目录

mkdir shared

# 2. 设置组和SGID

sudo chgrp mygroup shared
sudo chmod 2775 shared

# 3. 创建文件并验证

touch shared/team.txt
ls -l shared/team.txt

# 4. 添加user2到mygroup

sudo usermod -aG mygroup user2
su - user2 -c "ls -l /home/user1/shared"

**预期输出**：

- `ls -l shared/team.txt`：类似`-rw-rw-r-- 1 user1 mygroup 0 May 28 08:57 team.txt`
- `ls -ld shared`：类似`drwxrwsr-x 2 user1 mygroup 4096 May 28 08:57 shared`
- `su - user2 ...`：显示`team.txt`

#### 答案 7：日志文件轮换与权限

# 1. 创建日志目录

sudo mkdir -p /var/log/myapp

# 2. 创建日志文件并写入内容

sudo touch /var/log/myapp/app.log
sudo echo "Application log entry" > /var/log/myapp/app.log

# 3. 设置权限和所有者

sudo chown myuser:mygroup /var/log/myapp/app.log
sudo chmod 640 /var/log/myapp/app.log

# 4. 配置Logrotate

sudo nano /etc/logrotate.d/myapp

# 写入：

/var/log/myapp/app.log {
    daily
    rotate 3
    compress
    missingok
    notifempty
    create 0640 myuser mygroup
}

# 5. 手动运行并验证

sudo logrotate -f /etc/logrotate.d/myapp
ls -l /var/log/myapp/

**预期输出**：

- `ls -l /var/log/myapp/`：显示`app.log`（`rw-r----- myuser mygroup`）、`app.log.1.gz`
- `zcat /var/log/myapp/app.log.1.gz`：`Application log entry`

# 
